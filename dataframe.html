

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Dask DataFrames &mdash; Dask Examples  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/style.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/explore.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Custom Workloads with Dask Delayed" href="delayed.html" />
    <link rel="prev" title="Dask Arrays" href="array.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

  

<nav id="explore-links">
  <a href="https://dask.pydata.org/">
    <img class="caption" src="_static/images/dask-horizontal-white.svg"/>
  </a>

  <ul>
    <li>
      <a>Get Started</a>
      <ul>
        <li><a href="https://dask.pydata.org/en/latest/install.html"> Install </a></li>
        <li><a href="https://mybinder.org/v2/gh/dask/dask-examples/master?urlpath=lab"> Examples </a></li>
        <li><a href="https://github.com/dask/dask-tutorial"> Tutorial </a></li>
        <li><a href="https://dask.pydata.org/en/latest/why.html"> Why Dask? </a></li>
        <li><a href="https://dask-stories.readthedocs.io/en/latest"> Use Cases </a></li>
        <li><a href="https://www.youtube.com/watch?v=RA_2qdipVng&list=PLRtz5iA93T4PQvWuoMnIyEIz1fXiJ5Pri"> Talks </a></li>
      </ul>
    </li>

    <li>
      <a href="">Algorithms</a>
      <ul>
        <li><a href="https://dask.pydata.org/en/latest/array.html">Arrays</a></li>
        <li><a href="https://dask.pydata.org/en/latest/dataframe.html">Dataframes</a></li>
        <li><a href="https://dask.pydata.org/en/latest/bag.html">Bags</a></li>
        <li><a href="https://dask.pydata.org/en/latest/delayed.html">Delayed (custom)</a></li>
        <li><a href="https://dask.pydata.org/en/latest/futures.html">Futures (real-time)</a></li>
        <li><a href="http://ml.dask.org">Machine Learning</a></li>
        <li><a href="https://xarray.pydata.org/en/latest/">XArray</a></li>
      </ul>
    </li>

    <li>
      <a href="https://dask.pydata.org/en/latest/setup.html">Deploy</a>
      <ul>
        <li><a href="https://dask-yarn.readthedocs.io/en/latest/"> Hadoop / Yarn </a></li>
        <li><a href="https://dask.pydata.org/en/latest/setup/kubernetes-helm.html"> Helm </a></li>
        <li><a href="https://dask.pydata.org/en/latest/setup/hpc.html"> HPC </a></li>
        <li><a href="https://dask-kubernetes.readthedocs.io/en/latest/"> Kubernetes </a></li>
        <li><a href="https://dask.pydata.org/en/latest/setup/single-machine.html"> Local </a></li>
      </ul>
    </li>

    <li>
      <a>Community</a>
      <ul>
        <li><a href="http://dask.pydata.org/en/latest/support.html">Ask for Help</a></li>
        <li><a href="https://github.com/dask">Github</a></li>
        <li><a href="https://stackoverflow.com/questions/tagged/dask">Stack Overflow</a></li>
        <li><a href="https://twitter.com/dask_dev">Twitter</a></li>
      </ul>
    </li>
  </ul>

</nav>


  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Dask Examples
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Basic Examples:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="array.html">Dask Arrays</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dask DataFrames</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Start-Dask-Client-for-Dashboard">Start Dask Client for Dashboard</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Create-Random-Dataframe">Create Random Dataframe</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Use-Standard-Pandas-Operations">Use Standard Pandas Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Persist-data-in-memory">Persist data in memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Time-Series-Operations">Time Series Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Set-Index">Set Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Groupby-Apply-with-Scikit-Learn">Groupby Apply with Scikit-Learn</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="delayed.html">Custom Workloads with Dask Delayed</a></li>
<li class="toctree-l1"><a class="reference internal" href="futures.html">Custom Workloads with Futures</a></li>
<li class="toctree-l1"><a class="reference internal" href="machine-learning.html">Dask for Machine Learning</a></li>
</ul>
<p class="caption"><span class="caption-text">Dataframes:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dataframes/01-data-access.html">DataFrames: Read and Write Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataframes/02-groupby.html">DataFrames: Groupby</a></li>
</ul>
<p class="caption"><span class="caption-text">Machine Learning:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="machine-learning/scale-scikit-learn.html">Scale Scikit-Learn for Small Data Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="machine-learning/parallel-prediction.html">Score and Predict Large Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="machine-learning/training-on-large-datasets.html">Train Models on Large Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="machine-learning/xgboost.html">Scale XGBoost</a></li>
<li class="toctree-l1"><a class="reference internal" href="machine-learning/voting-classifier.html">Use Voting Classifiers</a></li>
<li class="toctree-l1"><a class="reference internal" href="machine-learning/tpot.html">Automate Machine Learning with TPOT</a></li>
</ul>
<p class="caption"><span class="caption-text">Applications:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="embarrassingly-parallel.html">Embarrassingly parallel Workloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarrassingly-parallel.html#Start-Dask-Client-for-Dashboard">Start Dask Client for Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarrassingly-parallel.html#Define-your-computation-calling-function">Define your computation calling function</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarrassingly-parallel.html#Define-the-set-of-input-parameters-to-call-the-function">Define the set of input parameters to call the function</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarrassingly-parallel.html#Use-Dask-Delayed-to-make-our-function-lazy">Use Dask Delayed to make our function lazy</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarrassingly-parallel.html#Run-in-parallel">Run in parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarrassingly-parallel.html#Using-the-Futures-API">Using the Futures API</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarrassingly-parallel.html#Doing-some-analysis-on-the-results">Doing some analysis on the results</a></li>
<li class="toctree-l1"><a class="reference internal" href="embarrassingly-parallel.html#Handling-very-large-simulation-with-Bags">Handling very large simulation with Bags</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Dask Examples</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Dask DataFrames</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/dataframe.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<p>You can run this notebook in a <a class="reference external" href="https://mybinder.org/v2/gh/dask/dask-examples/master?urlpath=lab/tree/dataframe.ipynb">live session</a> <a class="reference external" href="https://mybinder.org/v2/gh/dask/dask-examples/master?urlpath=lab/tree/dataframe.ipynb&gt;"><img alt="Binder" src="https://mybinder.org/badge.svg" /></a> or view it <a class="reference external" href="https://github.com/dask/dask-examples/blob/master/dataframe.ipynb">on Github</a>.</p>
<div class="section" id="Dask-DataFrames">
<h1>Dask DataFrames<a class="headerlink" href="#Dask-DataFrames" title="Permalink to this headline">¶</a></h1>
<p>Dask Dataframes coordinate many Pandas dataframes, partitioned along an
index. They support a large subset of the Pandas API.</p>
<div class="section" id="Start-Dask-Client-for-Dashboard">
<h2>Start Dask Client for Dashboard<a class="headerlink" href="#Start-Dask-Client-for-Dashboard" title="Permalink to this headline">¶</a></h2>
<p>Starting the Dask Client is optional. It will provide a dashboard which
is useful to gain insight on the computation.</p>
<p>The link to the dashboard will become visible when you create the client
below. We recommend having it open on one side of your screen while
using your notebook on the other side. This can take some effort to
arrange your windows, but seeing them both at the same is very useful
when learning.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="k">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">progress</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">n_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">threads_per_worker</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">memory_limit</span><span class="o">=</span><span class="s1">&#39;1GB&#39;</span><span class="p">)</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[1]:
</pre></div>
</div>
<div class="output_area docutils container">
<table style="border: 2px solid white;">
<tr>
<td style="vertical-align: top; border: 0px solid white">
<h3>Client</h3>
<ul>
  <li><b>Scheduler: </b>tcp://127.0.0.1:35204
  <li><b>Dashboard: </b><a href='http://127.0.0.1:8787/status' target='_blank'>http://127.0.0.1:8787/status</a>
</ul>
</td>
<td style="vertical-align: top; border: 0px solid white">
<h3>Cluster</h3>
<ul>
  <li><b>Workers: </b>2</li>
  <li><b>Cores: </b>4</li>
  <li><b>Memory: </b>2.00 GB</li>
</ul>
</td>
</tr>
</table></div>
</div>
</div>
<div class="section" id="Create-Random-Dataframe">
<h2>Create Random Dataframe<a class="headerlink" href="#Create-Random-Dataframe" title="Permalink to this headline">¶</a></h2>
<p>We create a random timeseries of data with the following attributes:</p>
<ol class="arabic simple">
<li>It stores a record for every 10 seconds of the year 2000</li>
<li>It splits that year by month, keeping every month as a separate
Pandas dataframe</li>
<li>Along with a datetime index it has columns for names, ids, and
numeric values</li>
</ol>
<p>This is a small dataset of about 240 MB. Increase the number of days or
reduce the frequency to practice with a larger dataset.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">dask</span>
<span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">timeseries</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Unlike Pandas, Dask DataFrames are lazy and so no data is printed here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>x</th>
      <th>y</th>
    </tr>
    <tr>
      <th>npartitions=30</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01</th>
      <td>int64</td>
      <td>object</td>
      <td>float64</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>2000-01-02</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2000-01-30</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2000-01-31</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: make-timeseries, 30 tasks</div></div>
</div>
<p>But the column names and dtypes are known.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>id        int64
name     object
x       float64
y       float64
dtype: object
</pre></div>
</div>
</div>
<p>Some operations will automatically display the data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>x</th>
      <th>y</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01 00:00:00</th>
      <td>996</td>
      <td>Edith</td>
      <td>0.964149</td>
      <td>0.319118</td>
    </tr>
    <tr>
      <th>2000-01-01 00:00:01</th>
      <td>970</td>
      <td>Zelda</td>
      <td>-0.852095</td>
      <td>0.238282</td>
    </tr>
    <tr>
      <th>2000-01-01 00:00:02</th>
      <td>1015</td>
      <td>Ursula</td>
      <td>-0.730184</td>
      <td>0.513515</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Use-Standard-Pandas-Operations">
<h2>Use Standard Pandas Operations<a class="headerlink" href="#Use-Standard-Pandas-Operations" title="Permalink to this headline">¶</a></h2>
<p>Most common Pandas operations operate identically on Dask dataframes</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">df3</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[6]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Dask Series Structure:
npartitions=1
    float64
        ...
Name: x, dtype: float64
Dask Name: sqrt, 157 tasks
</pre></div>
</div>
</div>
<p>Call <code class="docutils literal notranslate"><span class="pre">.compute()</span></code> when you want your result as a Pandas dataframe.</p>
<p>If you started <code class="docutils literal notranslate"><span class="pre">Client()</span></code> above then you may want to watch the status
page during computation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">computed_df</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="nb">type</span><span class="p">(</span><span class="n">computed_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[7]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>pandas.core.series.Series
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">computed_df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[8]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>name
Alice       0.578668
Bob         0.577676
Charlie     0.576960
Dan         0.577930
Edith       0.576907
Frank       0.577605
George      0.578885
Hannah      0.578816
Ingrid      0.575441
Jerry       0.579544
Kevin       0.579086
Laura       0.577254
Michael     0.576109
Norbert     0.576852
Oliver      0.579505
Patricia    0.578320
Quinn       0.575125
Ray         0.578294
Sarah       0.578930
Tim         0.577980
Ursula      0.577382
Victor      0.576172
Wendy       0.578065
Xavier      0.578683
Yvonne      0.577754
Zelda       0.575745
Name: x, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="section" id="Persist-data-in-memory">
<h2>Persist data in memory<a class="headerlink" href="#Persist-data-in-memory" title="Permalink to this headline">¶</a></h2>
<p>If you have the available RAM for your dataset then you can persist data
in memory.</p>
<p>This allows future computations to be much faster.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Time-Series-Operations">
<h2>Time Series Operations<a class="headerlink" href="#Time-Series-Operations" title="Permalink to this headline">¶</a></h2>
<p>Because we have a datetime index time-series operations work efficiently</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01 00:00:00</th>
      <td>0.007952</td>
      <td>0.003628</td>
    </tr>
    <tr>
      <th>2000-01-01 01:00:00</th>
      <td>-0.008343</td>
      <td>-0.019205</td>
    </tr>
    <tr>
      <th>2000-01-01 02:00:00</th>
      <td>0.016362</td>
      <td>-0.014436</td>
    </tr>
    <tr>
      <th>2000-01-01 03:00:00</th>
      <td>-0.005320</td>
      <td>-0.004875</td>
    </tr>
    <tr>
      <th>2000-01-01 04:00:00</th>
      <td>-0.018829</td>
      <td>0.005451</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;24h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[12]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7ff1083fe5c0&gt;
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/dataframe_21_1.png" src="_images/dataframe_21_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="s1">&#39;24h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-01 00:00:00</th>
      <td>0.964149</td>
      <td>0.319118</td>
    </tr>
    <tr>
      <th>2000-01-01 00:00:01</th>
      <td>0.056027</td>
      <td>0.278700</td>
    </tr>
    <tr>
      <th>2000-01-01 00:00:02</th>
      <td>-0.206043</td>
      <td>0.356972</td>
    </tr>
    <tr>
      <th>2000-01-01 00:00:03</th>
      <td>-0.094927</td>
      <td>0.355940</td>
    </tr>
    <tr>
      <th>2000-01-01 00:00:04</th>
      <td>-0.126982</td>
      <td>0.402597</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Random access is cheap along the index, but must still be computed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2000-01-05&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>x</th>
      <th>y</th>
    </tr>
    <tr>
      <th>npartitions=1</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-05 00:00:00.000000000</th>
      <td>int64</td>
      <td>object</td>
      <td>float64</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:59.999999999</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: loc, 31 tasks</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">time</span> df.loc[&#39;2000-01-05&#39;].compute()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 36 ms, sys: 16 ms, total: 52 ms
Wall time: 74.5 ms
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>x</th>
      <th>y</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2000-01-05 00:00:00</th>
      <td>931</td>
      <td>Frank</td>
      <td>-0.487465</td>
      <td>0.987371</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:01</th>
      <td>1012</td>
      <td>George</td>
      <td>0.839178</td>
      <td>-0.623056</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:02</th>
      <td>1081</td>
      <td>Edith</td>
      <td>-0.588858</td>
      <td>0.728163</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:03</th>
      <td>1011</td>
      <td>Norbert</td>
      <td>-0.993895</td>
      <td>-0.948026</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:04</th>
      <td>1001</td>
      <td>Michael</td>
      <td>-0.335235</td>
      <td>-0.177998</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:05</th>
      <td>1058</td>
      <td>Norbert</td>
      <td>0.856075</td>
      <td>0.998046</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:06</th>
      <td>1009</td>
      <td>Frank</td>
      <td>0.685753</td>
      <td>0.873472</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:07</th>
      <td>1028</td>
      <td>Ingrid</td>
      <td>0.278999</td>
      <td>-0.944866</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:08</th>
      <td>920</td>
      <td>Ingrid</td>
      <td>-0.292303</td>
      <td>-0.218876</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:09</th>
      <td>1039</td>
      <td>Yvonne</td>
      <td>-0.485051</td>
      <td>0.507407</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:10</th>
      <td>1058</td>
      <td>Xavier</td>
      <td>-0.115296</td>
      <td>-0.251822</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:11</th>
      <td>1007</td>
      <td>Jerry</td>
      <td>-0.754899</td>
      <td>0.157385</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:12</th>
      <td>988</td>
      <td>Kevin</td>
      <td>0.016207</td>
      <td>0.756106</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:13</th>
      <td>991</td>
      <td>Zelda</td>
      <td>-0.518981</td>
      <td>-0.769068</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:14</th>
      <td>1058</td>
      <td>Hannah</td>
      <td>0.168522</td>
      <td>-0.730890</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:15</th>
      <td>1009</td>
      <td>Zelda</td>
      <td>-0.981634</td>
      <td>0.852917</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:16</th>
      <td>1039</td>
      <td>Ursula</td>
      <td>0.150632</td>
      <td>0.686565</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:17</th>
      <td>1039</td>
      <td>Oliver</td>
      <td>0.268274</td>
      <td>-0.725729</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:18</th>
      <td>960</td>
      <td>Frank</td>
      <td>0.294752</td>
      <td>0.144533</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:19</th>
      <td>969</td>
      <td>Norbert</td>
      <td>0.851869</td>
      <td>0.339481</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:20</th>
      <td>1020</td>
      <td>Edith</td>
      <td>-0.507137</td>
      <td>0.381116</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:21</th>
      <td>934</td>
      <td>Edith</td>
      <td>0.027068</td>
      <td>0.813428</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:22</th>
      <td>955</td>
      <td>Frank</td>
      <td>-0.079324</td>
      <td>-0.177703</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:23</th>
      <td>980</td>
      <td>Ray</td>
      <td>0.637600</td>
      <td>-0.423289</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:24</th>
      <td>950</td>
      <td>Tim</td>
      <td>-0.366678</td>
      <td>0.405042</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:25</th>
      <td>1011</td>
      <td>Alice</td>
      <td>-0.485266</td>
      <td>0.769237</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:26</th>
      <td>951</td>
      <td>Michael</td>
      <td>-0.054795</td>
      <td>-0.486009</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:27</th>
      <td>979</td>
      <td>Charlie</td>
      <td>-0.995983</td>
      <td>-0.252571</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:28</th>
      <td>1048</td>
      <td>Victor</td>
      <td>0.418636</td>
      <td>0.077154</td>
    </tr>
    <tr>
      <th>2000-01-05 00:00:29</th>
      <td>969</td>
      <td>Quinn</td>
      <td>0.023735</td>
      <td>-0.052097</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:30</th>
      <td>985</td>
      <td>Bob</td>
      <td>0.705033</td>
      <td>-0.328292</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:31</th>
      <td>1055</td>
      <td>Edith</td>
      <td>0.266444</td>
      <td>-0.930810</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:32</th>
      <td>1015</td>
      <td>Laura</td>
      <td>0.617238</td>
      <td>-0.283847</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:33</th>
      <td>971</td>
      <td>Wendy</td>
      <td>0.692398</td>
      <td>-0.398328</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:34</th>
      <td>989</td>
      <td>Bob</td>
      <td>0.409832</td>
      <td>-0.792071</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:35</th>
      <td>1018</td>
      <td>Ursula</td>
      <td>-0.304100</td>
      <td>0.049640</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:36</th>
      <td>1039</td>
      <td>Norbert</td>
      <td>0.546873</td>
      <td>-0.301350</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:37</th>
      <td>1022</td>
      <td>Kevin</td>
      <td>-0.912782</td>
      <td>-0.192459</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:38</th>
      <td>1057</td>
      <td>Jerry</td>
      <td>0.602239</td>
      <td>-0.337901</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:39</th>
      <td>1025</td>
      <td>Yvonne</td>
      <td>-0.094060</td>
      <td>0.194182</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:40</th>
      <td>1042</td>
      <td>Patricia</td>
      <td>-0.924058</td>
      <td>-0.429625</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:41</th>
      <td>1006</td>
      <td>George</td>
      <td>-0.511206</td>
      <td>0.964647</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:42</th>
      <td>1015</td>
      <td>Ursula</td>
      <td>0.703445</td>
      <td>-0.918912</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:43</th>
      <td>1024</td>
      <td>George</td>
      <td>0.105369</td>
      <td>0.272583</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:44</th>
      <td>1026</td>
      <td>Sarah</td>
      <td>0.855395</td>
      <td>0.659441</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:45</th>
      <td>980</td>
      <td>Ingrid</td>
      <td>0.395247</td>
      <td>0.926241</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:46</th>
      <td>1032</td>
      <td>Alice</td>
      <td>0.158908</td>
      <td>0.800398</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:47</th>
      <td>990</td>
      <td>Frank</td>
      <td>-0.994384</td>
      <td>-0.143630</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:48</th>
      <td>959</td>
      <td>Bob</td>
      <td>-0.204987</td>
      <td>0.317789</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:49</th>
      <td>1023</td>
      <td>Charlie</td>
      <td>0.869681</td>
      <td>0.344000</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:50</th>
      <td>962</td>
      <td>Edith</td>
      <td>-0.085241</td>
      <td>-0.801857</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:51</th>
      <td>979</td>
      <td>George</td>
      <td>0.162932</td>
      <td>-0.051531</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:52</th>
      <td>999</td>
      <td>Ursula</td>
      <td>-0.009046</td>
      <td>0.513356</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:53</th>
      <td>919</td>
      <td>Tim</td>
      <td>0.817513</td>
      <td>0.499403</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:54</th>
      <td>1012</td>
      <td>Laura</td>
      <td>0.840310</td>
      <td>0.021814</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:55</th>
      <td>991</td>
      <td>Wendy</td>
      <td>0.070732</td>
      <td>0.017623</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:56</th>
      <td>983</td>
      <td>Yvonne</td>
      <td>0.657252</td>
      <td>0.876976</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:57</th>
      <td>1032</td>
      <td>Yvonne</td>
      <td>-0.190032</td>
      <td>0.481215</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:58</th>
      <td>956</td>
      <td>Laura</td>
      <td>0.290195</td>
      <td>0.549944</td>
    </tr>
    <tr>
      <th>2000-01-05 23:59:59</th>
      <td>1019</td>
      <td>Xavier</td>
      <td>0.709693</td>
      <td>-0.790635</td>
    </tr>
  </tbody>
</table>
<p>86400 rows × 4 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Set-Index">
<h2>Set Index<a class="headerlink" href="#Set-Index" title="Permalink to this headline">¶</a></h2>
<p>Data is sorted by the index column. This allows for faster access,
joins, groupby-apply operations, etc.. However sorting data can be
costly to do in parallel, so setting the index is both important to do,
but only infrequently.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>x</th>
      <th>y</th>
    </tr>
    <tr>
      <th>npartitions=30</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alice</th>
      <td>int64</td>
      <td>float64</td>
      <td>float64</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Zelda</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Zelda</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: sort_index, 1200 tasks</div></div>
</div>
<p>Because computing this dataset is expensive and we can fit it in our
available RAM, we persist the dataset to memory.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Dask now knows where all data lives, indexed cleanly by name. As a
result oerations like random access are cheap and efficient</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">time</span> df.loc[&#39;Alice&#39;].compute()
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CPU times: user 940 ms, sys: 72 ms, total: 1.01 s
Wall time: 3.93 s
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>x</th>
      <th>y</th>
    </tr>
    <tr>
      <th>name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Alice</th>
      <td>1015</td>
      <td>-0.861491</td>
      <td>0.345343</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>948</td>
      <td>0.655632</td>
      <td>-0.782884</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1042</td>
      <td>0.721626</td>
      <td>-0.212700</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1017</td>
      <td>-0.360104</td>
      <td>-0.904409</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>977</td>
      <td>-0.758540</td>
      <td>-0.426593</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>992</td>
      <td>0.237511</td>
      <td>-0.267511</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>976</td>
      <td>-0.103402</td>
      <td>0.476239</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1019</td>
      <td>-0.779449</td>
      <td>-0.281318</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>944</td>
      <td>0.255215</td>
      <td>0.151282</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>999</td>
      <td>0.529760</td>
      <td>-0.849276</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>990</td>
      <td>-0.017371</td>
      <td>-0.152248</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>906</td>
      <td>0.581563</td>
      <td>0.703162</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>938</td>
      <td>-0.620794</td>
      <td>-0.932938</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1001</td>
      <td>-0.166825</td>
      <td>0.660974</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>964</td>
      <td>-0.298365</td>
      <td>0.288769</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1072</td>
      <td>0.790722</td>
      <td>-0.476565</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>997</td>
      <td>0.767849</td>
      <td>0.191069</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1002</td>
      <td>-0.216572</td>
      <td>0.821717</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1006</td>
      <td>0.696431</td>
      <td>-0.590733</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1021</td>
      <td>0.086697</td>
      <td>0.823046</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>957</td>
      <td>-0.328496</td>
      <td>-0.248459</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1045</td>
      <td>-0.567410</td>
      <td>-0.052291</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>961</td>
      <td>-0.061416</td>
      <td>0.927136</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>988</td>
      <td>-0.017651</td>
      <td>0.673241</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>996</td>
      <td>-0.676006</td>
      <td>-0.486122</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1017</td>
      <td>-0.613786</td>
      <td>0.999508</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>991</td>
      <td>-0.145142</td>
      <td>-0.583167</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1003</td>
      <td>-0.500543</td>
      <td>0.537674</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1008</td>
      <td>-0.951048</td>
      <td>0.689986</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1006</td>
      <td>0.400020</td>
      <td>0.553455</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1005</td>
      <td>-0.797635</td>
      <td>-0.718213</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>980</td>
      <td>0.997159</td>
      <td>-0.855258</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>998</td>
      <td>0.743934</td>
      <td>-0.026626</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1018</td>
      <td>-0.144620</td>
      <td>-0.499857</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>943</td>
      <td>-0.018380</td>
      <td>-0.922240</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>971</td>
      <td>0.800047</td>
      <td>-0.571512</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1002</td>
      <td>0.381257</td>
      <td>0.701039</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1024</td>
      <td>-0.885033</td>
      <td>0.645001</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1070</td>
      <td>0.597955</td>
      <td>-0.199717</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1032</td>
      <td>0.798858</td>
      <td>0.023451</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>968</td>
      <td>0.385763</td>
      <td>0.669082</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>995</td>
      <td>0.694289</td>
      <td>-0.048540</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>993</td>
      <td>0.630068</td>
      <td>-0.950926</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>998</td>
      <td>0.854528</td>
      <td>-0.809650</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1027</td>
      <td>-0.557361</td>
      <td>0.124995</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>973</td>
      <td>0.966724</td>
      <td>0.755317</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>958</td>
      <td>0.181091</td>
      <td>-0.543507</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1014</td>
      <td>0.673205</td>
      <td>0.800025</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1021</td>
      <td>-0.565208</td>
      <td>-0.001309</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>983</td>
      <td>0.120993</td>
      <td>-0.645086</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>997</td>
      <td>0.234433</td>
      <td>-0.445744</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>989</td>
      <td>-0.664457</td>
      <td>0.393407</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>944</td>
      <td>-0.617843</td>
      <td>0.327259</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>973</td>
      <td>-0.903451</td>
      <td>0.658898</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>991</td>
      <td>0.924327</td>
      <td>-0.343195</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1011</td>
      <td>-0.823545</td>
      <td>-0.859828</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1078</td>
      <td>-0.984333</td>
      <td>-0.451367</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1039</td>
      <td>-0.431657</td>
      <td>-0.056583</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1000</td>
      <td>-0.967597</td>
      <td>-0.847912</td>
    </tr>
    <tr>
      <th>Alice</th>
      <td>1011</td>
      <td>-0.733882</td>
      <td>0.209408</td>
    </tr>
  </tbody>
</table>
<p>99640 rows × 3 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Groupby-Apply-with-Scikit-Learn">
<h2>Groupby Apply with Scikit-Learn<a class="headerlink" href="#Groupby-Apply-with-Scikit-Learn" title="Permalink to this headline">¶</a></h2>
<p>Now that our data is sorted by name we can easily do operations like
random access on name, or groupby-apply with custom functions.</p>
<p>Here we train a different Scikit-Learn linear regression model on each
name.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span>  <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>

<span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">partition</span><span class="p">):</span>
    <span class="n">est</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">est</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">partition</span><span class="p">[[</span><span class="s1">&#39;x&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">partition</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">est</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">meta</span><span class="o">=</span><span class="nb">object</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>name
Alice       LinearRegression(copy_X=True, fit_intercept=Tr...
Bob         LinearRegression(copy_X=True, fit_intercept=Tr...
Charlie     LinearRegression(copy_X=True, fit_intercept=Tr...
Dan         LinearRegression(copy_X=True, fit_intercept=Tr...
Edith       LinearRegression(copy_X=True, fit_intercept=Tr...
Frank       LinearRegression(copy_X=True, fit_intercept=Tr...
George      LinearRegression(copy_X=True, fit_intercept=Tr...
Hannah      LinearRegression(copy_X=True, fit_intercept=Tr...
Ingrid      LinearRegression(copy_X=True, fit_intercept=Tr...
Jerry       LinearRegression(copy_X=True, fit_intercept=Tr...
Kevin       LinearRegression(copy_X=True, fit_intercept=Tr...
Laura       LinearRegression(copy_X=True, fit_intercept=Tr...
Michael     LinearRegression(copy_X=True, fit_intercept=Tr...
Norbert     LinearRegression(copy_X=True, fit_intercept=Tr...
Oliver      LinearRegression(copy_X=True, fit_intercept=Tr...
Patricia    LinearRegression(copy_X=True, fit_intercept=Tr...
Quinn       LinearRegression(copy_X=True, fit_intercept=Tr...
Ray         LinearRegression(copy_X=True, fit_intercept=Tr...
Sarah       LinearRegression(copy_X=True, fit_intercept=Tr...
Tim         LinearRegression(copy_X=True, fit_intercept=Tr...
Ursula      LinearRegression(copy_X=True, fit_intercept=Tr...
Victor      LinearRegression(copy_X=True, fit_intercept=Tr...
Wendy       LinearRegression(copy_X=True, fit_intercept=Tr...
Xavier      LinearRegression(copy_X=True, fit_intercept=Tr...
Yvonne      LinearRegression(copy_X=True, fit_intercept=Tr...
Zelda       LinearRegression(copy_X=True, fit_intercept=Tr...
dtype: object
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="delayed.html" class="btn btn-neutral float-right" title="Custom Workloads with Dask Delayed" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="array.html" class="btn btn-neutral" title="Dask Arrays" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Dask Developers.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>